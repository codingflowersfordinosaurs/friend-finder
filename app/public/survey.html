<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <title>Friend Finder</title>
    <style>
      label {
        display: block;
      }
      img {
        max-width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Survey Questions</h1>
      <hr />
      <h2>About You</h2>
      <!-- NAME FORM-->
      <div class="forms">
        <label for="name" class="main-label">Name (Required)</label>
        <input type="text" name="name" id="name" class="form-const" required />
      </div>
      <!-- PICTURE FORM-->
      <div class="forms">
        <label for="picture" class="main-label"
          >Link to Picture (Required)</label
        >
        <input
          type="text"
          name="picture"
          id="picture"
          class="form-const"
          required
        />
      </div>

      <!-- QUESTION FORM -->
      <!-- QUESTION 1 -->
      <div class="forms">
        <h2>Question 1</h2>
        <label for="question1" class="main-label">You like pizza.</label>
        <select class="select-choice" id="question1">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- QUESTION 2 -->
      <div class="forms">
        <h2>Question 2</h2>
        <label for="question2" class="main-label">You like using your imagination.</label>
        <select class="select-choice" id="question2">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- QUESTION 3 -->
      <div class="forms">
        <h2>Question 3</h2>
        <label for="question3" class="main-label">You like reading.</label>
        <select class="select-choice" id="question3">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- QUESTION 4 -->
      <div class="forms">
        <h2>Question 4</h2>
        <label for="question4" class="main-label">You like exercising.</label>
        <select class="select-choice" id="question4">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- QUESTION 5 -->
      <div class="forms">
        <h2>Question 5</h2>
        <label for="question5" class="main-label">You rarely let people upset you.</label>
        <select class="select-choice" id="question5">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- QUESTION 6 -->
      <div class="forms">
        <h2>Question 6</h2>
        <label for="question6" class="main-label">You don't care how people feel.</label>
        <select class="select-choice" id="question6">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- QUESTION 7 -->
      <div class="forms">
        <h2>Question 7</h2>
        <label for="question7" class="main-label">You don't believe in religion.</label>
        <select class="select-choice" id="question7">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- QUESTION 8 -->
      <div class="forms">
        <h2>Question 8</h2>
        <label for="question8" class="main-label">You like doing nothing with no one.</label>
        <select class="select-choice" id="question8">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- QUESTION 9 -->
      <div class="forms">
        <h2>Question 9</h2>
        <label for="question9" class="main-label">You like vegetables.</label>
        <select class="select-choice" id="question9">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- QUESTION 10 -->
      <div class="forms">
        <h2>Question 10</h2>
        <label for="question10" class="main-label">You like ice cream.</label>
        <select class="select-choice" id="question10">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>

      <!-- SUBMIT BUTTON -->
      <button type="submit" class="btn btn-primary" id="submit">
        Submit
      </button>

      <!-- MODAL -->
      <div class="modal fade" id="modal-pop" role="dialog">
        <div class="modal-communication">
          <!-- MODAL TEXT -->
          <div class="modal-text">
            <!-- MODAL HEADER -->
            <div class="modal-header">
              <button type="button" data-dismiss="modal" class="close"></button>
              <h1 class="modal-header">Your New Friend</h1>
            </div>
            <!-- MODAL BODY - HOLDS MATCH NAME AND IMAGE OF MATCH -->
            <div class="modal-body">
              <h1 id="friendName"></h1>
              <img id="friendImage" src="" alt="" />
            </div>
            <!-- MODAL FOOTER -->
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-default"
                data-dismiss="modal"
              >
                Close
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- SCRIPT CDNs -->
    <script
    src="https://code.jquery.com/jquery-3.4.0.js"
    integrity="sha256-DYZMCC8HTC+QDr5QNaIcfR7VSPtcISykd+6eSmBW5qo="
    crossorigin="anonymous"></script>
    <script
  src="https://code.jquery.com/jquery-3.4.0.min.js"
  integrity="sha256-BJeo0qm959uMBGb65z40ejJYGSgR7REI4+CW1fNKwOg="
  crossorigin="anonymous"></script>
    <!-- SCRIPT -->
    <script>

      // submit button on click event
      $("#submit").on("click", (event) => {
        event.preventDefault();
        let tally = []; // score of points
        let prove = true;

        $(".form-const").each(() => {
          if ($(this).val() === '') {
            prove = false; // means form won't work if no name/pic
            $(this).parent().addClass('error-found');
          }
          else {
            $(this).parent().removeClass("error-found");
          }
        });

        $(".select-choice").each(() => {
          if ($("this").val() === '') {
            prove = false; // won't work if selections not picked
            $(this).parent().addClass("error-found");
          }
          else {
            $(this).parent().removeClass("error-found");
          }
        });

        if (prove) {
          $(".select-choice").each(() => {
            tally.push($(this).val());
          });
          for (var i = 0; i < tally.length; i++) {
            tally[i] = parseInt(tally[i]);
          }
          let new_survey = {
            name: $("#name").val().trim(),
            picture: $("#picture").val().trim(),
            scores: tally
          };
          console.log(new_survey);
          $.post("/api/friends", new_survey).done((data) => {
            console.log(data);
            $("#modal-pop").modal("toggle");
            $("#friendName").text(data[0].name);
            $("#friendImage").attr("src", data[0].picture);
          });
        }
        else {
          alert("Go back! You missed something!");
        }
      });
      // choosing selections
      // $(".select-choice").chosen();
    </script>
  </body>
</html>
